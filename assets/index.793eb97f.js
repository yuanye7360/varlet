import{I as ye}from"./index.388f0ba6.js";import{M as be}from"./index.580764d0.js";import{C as he}from"./index.4b42bb6e.js";import{F as ge,u as Ce}from"./provide.24680078.js";import{d as Ve,a as m,b as A,w as O,_ as Fe,aI as S,n as _,s as B,f as u,h as y,l as v,H as r,J as $,t as U,P as W,K as C,F as we,ad as ke,i as x,M as Me,N as T,ac as Se,k as ee,ap as Be}from"./elevation.b6664af0.js";import{i as Te,e as t,c as De}from"./components.1dfa4f07.js";import{u as Ee}from"./index.5a5ce06b.js";import{t as Y,g as Ne}from"./elements.e9a3cb11.js";function Ae(e){return["left","right","center"].includes(e)}const Oe={modelValue:{default:void 0},placeholder:{type:String},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},line:{type:Boolean,default:!0},hint:{type:Boolean,default:!0},textColor:{type:String},focusColor:{type:String},blurColor:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:Ae},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:{type:Function},onBlur:{type:Function},onClick:{type:Function},onClear:{type:Function},onClose:{type:Function},onChange:{type:Function},"onUpdate:modelValue":{type:Function}};const{n:H,classes:$e}=De("select"),Ue=Ve({name:"VarSelect",components:{VarIcon:ye,VarMenu:be,VarChip:he,VarFormDetails:ge},props:Oe,setup(e){const i=m(null),f=m(!1),z=A(()=>e.multiple),I=A(()=>e.focusColor),V=m(""),F=m([]),b=m("0px"),d=m(0),{bindForm:D,form:l}=Ce(),{length:le,options:h,bindOptions:ae}=Ee(),{errorMessage:se,validateWithTrigger:ne,validate:oe,resetValidation:E}=Te(),L=m(null),re=()=>{const{multiple:s,modelValue:a}=e;if(s){const n=a;F.value=n.map(j)}!s&&!S(a)&&(V.value=j(a)),!s&&S(a)&&(V.value="")},g=s=>{_(()=>{const{validateTrigger:a,rules:n,modelValue:o}=e;ne(a,s,n,o)})},w=({value:s,label:a})=>s.value!=null?s.value:a.value,j=s=>{var n;let a=h.find(({value:o})=>o.value===s);return a||(a=h.find(({label:o})=>o.value===s)),(n=a==null?void 0:a.label.value)!=null?n:""},ie=()=>{const{hint:s,modelValue:a}=e;if(!s&&!S(a))return H("--placeholder-hidden");if(s&&(!S(a)||f.value))return H("--placeholder-hint")},J=()=>i.value&&window.getComputedStyle(i.value).width||"0px",k=()=>{const s=i.value&&window.getComputedStyle(i.value).paddingTop||"0px";return Y(s)*1.5},te=()=>{const{disabled:s,readonly:a,onFocus:n}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||(b.value=J(),d.value=k()+Y(e.offsetY),f.value=!0,t(n),g("onFocus"),Q())},de=()=>{const{disabled:s,readonly:a,onBlur:n}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||(t(n),g("onBlur"))},ue=s=>{const{disabled:a,readonly:n,multiple:o,onChange:c}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||n)return;const p=o?h.filter(({selected:M})=>M.value).map(w):w(s);t(e["onUpdate:modelValue"],p),t(c,p),g("onChange"),!o&&(f.value=!1)},ce=()=>{const{disabled:s,readonly:a,multiple:n,clearable:o,onClear:c}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||!o)return;const p=n?[]:void 0;t(e["onUpdate:modelValue"],p),t(c,p),g("onClear")},ve=s=>{const{disabled:a,onClick:n}=e;(l==null?void 0:l.disabled.value)||a||(t(n,s),g("onClick"))},fe=s=>{const{disabled:a,readonly:n,modelValue:o,onClose:c}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||n)return;const p=o,M=h.find(({label:N})=>N.value===s),X=p.filter(N=>{var Z;return N!==((Z=M.value.value)!=null?Z:M.label.value)});t(e["onUpdate:modelValue"],X),t(c,X),g("onClose")},K=()=>{const{multiple:s,modelValue:a}=e;if(s){const n=a;h.forEach(o=>o.sync(n.includes(w(o))))}else h.forEach(n=>n.sync(a===w(n)));re()},pe=()=>{b.value=J(),d.value=k()+Y(e.offsetY),f.value=!0,Q()},me=()=>{f.value=!1},q=()=>oe(e.rules,e.modelValue),G=()=>{t(e["onUpdate:modelValue"],e.multiple?[]:void 0),E()},Q=()=>{const{body:s}=document,a=s.scrollHeight;_(()=>{var c;const{offsetHeight:n}=(c=L.value)==null?void 0:c.parentElement,o=Ne(i.value);o+d.value<0&&(d.value=k()),n+o+d.value>a&&(d.value-=n-k())})};O(()=>e.multiple,()=>{const{multiple:s,modelValue:a}=e;if(s&&!Be(a))throw Error("The modelValue must be an array when multiple is true")}),O(()=>e.modelValue,K,{deep:!0}),O(()=>le.value,K);const R={wrapWidth:A(()=>b.value),multiple:z,focusColor:I,onSelect:ue,reset:G,validate:q,resetValidation:E};return ae(R),t(D,R),{wrapEl:i,offsetY:d,isFocus:f,errorMessage:se,formDisabled:l==null?void 0:l.disabled,label:V,labels:F,menuEl:L,n:H,classes:$e,computePlaceholderState:ie,handleFocus:te,handleBlur:de,handleClear:ce,handleClick:ve,handleClose:fe,reset:G,validate:q,resetValidation:E,focus:pe,blur:me}}}),We={key:0},Ye={key:1};function He(e,i,f,z,I,V){const F=B("var-chip"),b=B("var-icon"),d=B("var-menu"),D=B("var-form-details");return u(),y("div",{class:r(e.classes(e.n(),"var--box",[e.formDisabled||e.disabled,e.n("--disabled")])),onClick:i[3]||(i[3]=(...l)=>e.handleClick&&e.handleClick(...l))},[v("div",{class:r(e.classes(e.n("controller"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:C({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},[v("div",{class:r(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[$(e.$slots,"prepend-icon")],2),U(d,{class:r(e.n("menu")),"var-select-cover":"","offset-y":e.offsetY,show:e.isFocus,"onUpdate:show":i[2]||(i[2]=l=>e.isFocus=l),onClose:e.handleBlur},{menu:W(()=>[v("div",{ref:"menuEl",class:r(e.n("scroller"))},[$(e.$slots,"default")],2)]),default:W(()=>[v("div",{class:r(e.classes(e.n("wrap"),[!e.hint,e.n("--non-hint")])),ref:"wrapEl",onClick:i[1]||(i[1]=(...l)=>e.handleFocus&&e.handleFocus(...l))},[v("div",{class:r(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:C({textAlign:e.textAlign,color:e.textColor})},[e.multiple?(u(),y("div",We,[e.chip?(u(),y("div",{key:0,class:r(e.n("chips"))},[(u(!0),y(we,null,ke(e.labels,l=>(u(),x(F,{class:r(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:l,onClick:i[0]||(i[0]=Se(()=>{},["stop"])),onClose:()=>e.handleClose(l)},{default:W(()=>[Me(T(l),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(u(),y("div",{key:1,class:r(e.n("values"))},T(e.labels.join(e.separator)),3))])):(u(),y("span",Ye,T(e.label),1)),U(b,{class:r(e.classes(e.n("arrow"),[e.isFocus,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])],6),v("label",{class:r(e.classes(e.n("placeholder"),"var--ellipsis",[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")],e.computePlaceholderState(),[!e.hint,e.n("--placeholder-non-hint")])),style:C({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},T(e.placeholder),7)],2)]),_:3},8,["class","offset-y","show","onClose"]),v("div",{class:r(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[$(e.$slots,"append-icon",{},()=>[e.clearable?(u(),x(b,{key:0,class:r(e.n("clear-icon")),name:"close-circle",size:"14px",onClick:e.handleClear},null,8,["class","onClick"])):ee("v-if",!0)])],2)],6),e.line?(u(),y("div",{key:0,class:r(e.classes(e.n("line"),[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:C({background:e.errorMessage?void 0:e.blurColor})},[v("div",{class:r(e.classes(e.n("dot"),[e.isFocus,e.n("--spread")],[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:C({background:e.errorMessage?void 0:e.focusColor})},null,6)],6)):ee("v-if",!0),U(D,{"error-message":e.errorMessage},null,8,["error-message"])],2)}var P=Fe(Ue,[["render",He]]);P.install=function(e){e.component(P.name,P)};export{P as S};
